services:
  open-webui:
    image: ghcr.io/open-webui/open-webui:main
    container_name: open-webui
    volumes:
      - ./data/open-webui:/app/backend/data
    ports:
      - 8080:8080
    environment:
      - 'WEBUI_SECRET_KEY='
      - 'ENABLE_OLLAMA_API=false'
      - 'OPENAI_API_BASE_URL=http://litellm:4000'
      - 'OPENAI_API_KEY=sk-12345'

  litellm:
    image: ghcr.io/berriai/litellm:main-stable
    volumes:
      - ./litellm/config.yaml:/config.yaml
    command: [ "--config", "/config.yaml" ]
    # bedrockにアクセス権限のあるクレデンシャル情報
    environment:
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      AWS_SESSION_TOKEN: ${AWS_SESSION_TOKEN}
      AWS_REGION_NAME: ${AWS_REGION}

  mcpo:
    image: ghcr.io/open-webui/mcpo:main
    ports:
      - 8000:8000
    volumes:
      - ./mcpo/config.yaml:/config.yaml
    command: [ "--config", "/config.yaml" ]